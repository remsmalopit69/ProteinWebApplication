@{
    ViewBag.Title = "Products";
    Layout = "~/Views/Shared/_PublicLayout.cshtml";
}

<div ng-init="loadProducts(); loadCategories();" class="bg-white min-h-screen">

    <section class="pt-16 pb-8 border-b border-gray-100">
        <div class="container mx-auto px-4">
            <div class="max-w-3xl">
                <span class="text-xs font-bold tracking-widest text-gray-500 uppercase mb-2 block">Shop</span>
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4 tracking-tight">All Products</h1>
                <p class="text-gray-500 text-lg">
                    Browse our complete collection of premium protein supplements from trusted international brands.
                </p>
            </div>
        </div>
    </section>

    <section class="py-12">
        <div class="container mx-auto px-4">
            <div class="flex flex-col lg:flex-row gap-12">

                <aside class="w-full lg:w-64 flex-shrink-0">
                    <div class="sticky top-24 space-y-8">

                        <div>
                            <h3 class="font-bold text-gray-900 mb-6 uppercase text-xs tracking-wider border-b border-gray-100 pb-2">
                                Categories
                            </h3>

                            <div class="space-y-1">
                                <button ng-click="filterByCategory(null)"
                                        class="w-full text-left py-2 text-sm transition-all duration-200 group flex items-center justify-between"
                                        ng-class="{'font-bold text-black': selectedCategory === null, 'text-gray-500 hover:text-black': selectedCategory !== null}">
                                    <span>All Products</span>
                                    <i class="fas fa-chevron-right text-xs opacity-0 group-hover:opacity-100 transition-opacity" ng-if="selectedCategory !== null"></i>
                                </button>

                                <button ng-repeat="category in categories"
                                        ng-click="filterByCategory(category.categoryID)"
                                        class="w-full text-left py-2 text-sm transition-all duration-200 group flex items-center justify-between"
                                        ng-class="{'font-bold text-black': selectedCategory === category.categoryID, 'text-gray-500 hover:text-black': selectedCategory !== category.categoryID}">
                                    <span>{{category.categoryName}}</span>
                                    <span class="text-xs text-gray-400" ng-class="{'text-black font-normal': selectedCategory === category.categoryID}">
                                        {{category.productCount}}
                                    </span>
                                </button>
                            </div>
                        </div>

                        <div class="bg-gray-50 p-6 rounded-xl border border-gray-100 hidden lg:block">
                            <i class="fas fa-shield-alt text-2xl text-gray-900 mb-3"></i>
                            <h4 class="font-bold text-sm text-gray-900 mb-1">100% Authentic</h4>
                            <p class="text-xs text-gray-500 leading-relaxed">
                                We guarantee all our products are sourced directly from authorized distributors.
                            </p>
                        </div>
                    </div>
                </aside>

                <div class="flex-1">

                    <div class="flex flex-col sm:flex-row justify-between items-center mb-8 pb-4 border-b border-gray-100">
                        <p class="text-sm text-gray-500 mb-4 sm:mb-0">
                            Showing <span class="font-bold text-gray-900">{{products.length}}</span> results
                        </p>
                        <div class="flex items-center space-x-2 text-sm">
                            <span class="text-gray-500">Sort by:</span>
                            <select class="border-none bg-transparent font-bold text-gray-900 focus:ring-0 cursor-pointer pr-8">
                                <option>Featured</option>
                                <option>Price: Low to High</option>
                                <option>Price: High to Low</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-12">
                        <div ng-repeat="product in products" class="group">

                            <div class="relative aspect-[4/5] bg-gray-50 rounded-2xl overflow-hidden mb-5">
                                <span ng-if="product.stockQuantity === 0" class="absolute top-3 left-3 bg-black text-white text-[10px] font-bold px-3 py-1 uppercase tracking-wider rounded-full z-10">
                                    Sold Out
                                </span>
                                <span ng-if="product.price < 3000 && product.stockQuantity > 0" class="absolute top-3 left-3 bg-red-600 text-white text-[10px] font-bold px-3 py-1 uppercase tracking-wider rounded-full z-10">
                                    Sale
                                </span>

                                <img ng-src="{{product.image || 'https://via.placeholder.com/300x300?text=No+Image'}}"
                                     alt="{{product.productName}}"
                                     class="w-full h-full object-contain p-8 group-hover:scale-105 transition duration-500 mix-blend-multiply">

                                <div class="absolute inset-x-4 bottom-4 translate-y-full opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition duration-300 ease-out">
                                    <button ng-click="viewProduct(product.productID)"
                                            class="w-full bg-white text-black font-bold py-3 rounded-xl shadow-lg border border-gray-100 hover:bg-black hover:text-white transition flex items-center justify-center space-x-2">
                                        <i class="fas fa-eye text-xs"></i>
                                        <span>View Details</span>
                                    </button>
                                </div>
                            </div>

                            <div>
                                <div class="flex justify-between items-start mb-2">
                                    <span class="text-xs font-bold text-gray-400 uppercase tracking-wider">{{product.categoryName}}</span>

                                    <div class="flex items-center space-x-1">
                                        <i class="fas fa-star text-xs text-yellow-400"></i>
                                        <span class="text-xs font-medium text-gray-500">4.8</span>
                                    </div>
                                </div>

                                <h3 class="text-base font-bold text-gray-900 mb-2 leading-snug group-hover:text-gray-600 transition">
                                    <a href="#" ng-click="viewProduct(product.productID)">{{product.productName}}</a>
                                </h3>

                                <div class="flex items-center justify-between mt-3">
                                    <span class="text-lg font-bold text-gray-900">₱{{product.price | number:2}}</span>

                                    <button ng-click="viewProduct(product.productID)"
                                            class="text-xs font-bold uppercase tracking-wider border-b border-gray-300 pb-0.5 hover:border-black transition">
                                        Shop Now
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div ng-if="products.length === 0" class="text-center py-32 bg-gray-50 rounded-2xl mt-8">
                        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-white text-gray-300 mb-4 shadow-sm">
                            <i class="fas fa-search text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-bold text-gray-900 mb-2">No products found</h3>
                        <p class="text-gray-500">Try selecting a different category or clear your filters.</p>
                        <button ng-click="filterByCategory(null)" class="mt-6 text-black font-bold underline decoration-2 underline-offset-4 hover:text-gray-600">
                            Clear all filters
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </section>
</div>